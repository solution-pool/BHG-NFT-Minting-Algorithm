<!DOCTYPE html><html lang=""><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Coral Normal 1</title><style>body {padding: 0;margin: 0;}</style></head><body><canvas id="canvas"><script>
function _a(t,s,e){for(let i=0;i<s;i++)t[i]=e;return t}function _b(t,s,e){e[2*t]<0?e[2*t]=s:e[2*t+1]=s}function _c(t,s,e){return e[2*t]==s?(e[2*t]=e[2*t+1],e[2*t+1]=-1):e[2*t+1]==s&&(e[2*t+1]=-1),e}function _d(t,s,e){const n=t._o();let h=[],r=[];for(let t=0;t<n;t++)h.push(Math.random());const o=h.length;for(i=0;i<o;i++)h[i]>e||!h[i]||r.push(i);let l=r.length;for(let e=0;e<l;e++){if(!(t._k(r[e])<s))try{t._m(r[e])}catch(t){continue}}}Math.seedrandom=function(t){var s=4294967295,e=123456789+t&s,i=987654321-t&s;return function(){var t=((i=36969*(65535&i)+(i>>>16)&s)<<16)+(65535&(e=18e3*(65535&e)+(e>>>16)&s))>>>0;return t/=4294967296}};class Segments{constructor(t,s){this.X=[],_a(this.X,t,0),this.Y=[],_a(this.Y,t,0),this.VA=[],_a(this.VA,t,0),this.VS=[],_a(this.VS,t,-1),this.EV=[],_a(this.EV,2*t,-1),this.VE=[],_a(this.VE,2*t,-1),this.nmax=t,this.vnum=0,this.edgeNumber=0,this.snum=0,this.zonewidth=s,this.nz=1/s,this.nz<3&&(this.nz=1,this.zonewidth=1),this.zonemap=new Zonemap(this.nz),this.zonemap.__v(this.X,this.Y)}__e(t,s){return t<0||t>1||s<0||s>1?-1:1}_f(t,s,e){if(this.__e(t,s)<0)throw new Error("Vertext outside unit square.");const i=this.vnum;return this.X[i]=t,this.Y[i]=s,this.VA[i]=1,this.VS[i]=e,this.zonemap._ab(i),this.vnum=i+1,i}_g(t,s){t=parseInt(t),s=parseInt(s);const e=this.edgeNumber;return this.EV[2*e]=t,this.EV[2*e+1]=s,_b(t,e,this.VE),_b(s,e,this.VE),this.edgeNumber+=1,e}_h(t){return this.EV[2*t]>-1&&this.EV[2*t+1]>-1?1:-1}__del_edge(t){if(t<0||t>this.edgeNumber-1)throw new Error("invalid edge in __del_edge e1"+t);let s=this.EV[2*t],e=this.EV[2*t+1];return this.EV[2*t]=-1,this.EV[2*t+1]=-1,s>-1&&_c(s,t,this.VE),e>-1&&_c(e,t,this.VE),1}_j(t){let s=this.edgeNumber,e=0;for(let i=0;i<s;i++)if(this.EV[2*i]>-1){let s=this.EV[2*i],n=this.EV[2*i+1];t[e][0]=this.X[s],t[e][1]=this.Y[s],t[e][2]=this.X[n],t[e][3]=this.Y[n],e+=1}return e}_k(t){let s=this.X[this.EV[2*t]]-this.X[this.EV[2*t+1]],e=this.Y[this.EV[2*t]]-this.Y[this.EV[2*t+1]];return Math.sqrt(s*s+e*e)}_l(t,s,e,i){let n=[],h=this.snum,r=i.length;for(let o=0;o<r;o++){const r=i[o],l=t+Math.cos(r)*e,a=s+Math.sin(r)*e;n.push(this._f(l,a,h))}for(let t=0;t<n.length-1;t++)this._g(n[t],n[t+1]);this._g(n[0],n[r-1]),this.snum=h+1}_m(t,s=-1){if(this._h(t)<0)throw new Error("e1 does not exist");if(t<0)throw new Error("invalid edge in _m e1"+t);let e=this.EV[2*t],i=this.EV[2*t+1],n=this.VS[e];if(n<0)throw new Error("Invalid segment id.");if(s>0){let n=this.X[e]-this.X[i],h=this.Y[e]-this.Y[i];if(n*n+h*h<s*s)throw new Error("edge too short, e1,"+t)}let h=.5*(this.X[e]+this.X[i]),r=.5*(this.Y[e]+this.Y[i]),o=this._f(h,r,n);return this.__del_edge(t),this._g(e,o),this._g(i,o),1}_n(t){let s=this.vnum;for(let e=0;e<s;e++){if(this.X[e]<(RS-CURRENTSIZE)/2/RS+t||this.X[e]>1-(RS-CURRENTSIZE)/2/RS-t)return-1;if(this.Y[e]<(RS-CURRENTSIZE)/2/RS+t||this.Y[e]>1-(RS-CURRENTSIZE)/2/RS-t)return-1}return 1}_o(){return this.edgeNumber}}class DifferentialLine extends Segments{constructor(t,s,e,i){super(t,s),this.SX=new Array,this.SY=new Array,this.SD=new Array,this.nearl=e,this.farl=i}_q(t){let s=new Array;const e=this.vnum;for(let i=0;i<e;i++){this.SX[i]=0,this.SY[i]=0;let e=this.zonemap._aa(this.X[i],this.Y[i],this.farl,s);this.__r(i,s,e,t,this.SX,this.SY)}for(let t=0;t<e;t++)this.VA[t]<0||(this.X[t]=this.X[t]+this.SX[t],this.Y[t]=this.Y[t]+this.SY[t]);for(let t=0;t<e;t++)if(!(this.VA[t]<0))try{this.zonemap.___ad(t)}catch{}}__r(t,s,e,i,n,h){if(this.VA[t]<1)return-1;let r,o,l=this.VE[2*t],a=this.VE[2*t+1];r=this.EV[2*l]==t?this.EV[2*l+1]:this.EV[2*l],o=this.EV[2*a]==t?this.EV[2*a+1]:this.EV[2*a];let c=0,u=0;for(let n=0;n<e;n++){let e=s[n],h=this.X[t]-this.X[e],l=this.Y[t]-this.Y[e],a=Math.sqrt(h*h+l*l);if(e==r||e==o){if(a<this.nearl||a<=0)continue;c+=-h/a*i,u+=-l/a*i}else{if(a>this.farl||a<=0)continue;c+=h*(this.farl/a-1)*i,u+=l*(this.farl/a-1)*i}}return n[t]+=c,h[t]+=u,1}}function _s(){ctx.fillStyle="rgb("+BACK.toString()+")",ctx.fillRect(0,0,SIZE,SIZE)}function _t(t,s,e,i,n,h=2,r=!1){let o=t-e,l=s-i,a=Math.sqrt(o**2+l**2),c=parseInt(a/ONE);c<h&&(c=h);let u=Math.atan2(l,o),_=_u(0,a,c);for(let e=0;e<_.length;e++){let i=t-_[e]*Math.cos(u),h=s-_[e]*Math.sin(u);ctx.beginPath(),ctx.strokeStyle=r&&(!gf||pe)?"rgb("+BACK.toString()+")":CO<5?"rgb("+init_front.toString()+")":"rgb("+cf.toString()+")",ctx.arc(i*RS,h*RS,n*RS,0,TWOPI),ctx.stroke()}}function _u(t,s,e,i=!0){const n=(s-t)/(i?e-1:e);return Array.from({length:e},(s,e)=>t+n*e)}class Zonemap{constructor(t){t=parseInt(t);this.VZ=[],this.Z=[],this.vnum=0,this.vsize=RS,this.nz=t,this.total_zones=t*t,this.greatest_zone_size=RS;for(let t=0;t<this.total_zones;t++){let s=[];s.i=t,s.size=RS,s.count=0,s.ZV=[],this.Z[t]=s}}__v(t,s){this.X=t,this.Y=s}_w(t,s){t=parseInt(t),s=parseInt(s);let e=this.Z[t];return null==e&&((e=[]).count=0,e.ZV=[],e.i=0,e.size=SIZE,this.Z.push(e)),e.ZV[e.count]=s,e.count+=1,e.count>=e.size-1?this._v(e):1}_v(t){let s=2*t.size;return t.ZV=[],t.size=s,s>this.greatest_zone_size&&(this.greatest_zone_size=s),this.Z.push(t),1}_y(t,s){t=parseInt(t),s=parseInt(s);let e=this.Z[t];for(let t=0;t<e.count;t++)if(e.ZV[t]==s)return e.ZV[t]=e.ZV[e.count-1],e.count-=1,1;return-1}_z(t,s){const e=this.nz;return e*parseInt(t*e)+parseInt(s*e)}_aa(t,s,e,i){const n=this.nz,h=parseInt(t*n),r=parseInt(s*n);let o=0;const l=e*e;for(let e=Math.max(h-1,0);e<Math.min(h+2,n);e++)for(let h=Math.max(r-1,0);h<Math.min(r+2,n);h++){const r=this.Z[e*n+h];for(let e=0;e<r.count;e++){const n=t-this.X[r.ZV[e]],h=s-this.Y[r.ZV[e]];n*n+h*h<l&&(i[o]=r.ZV[e],o+=1)}}return o}_ab(t){t=parseInt(t);let s=this.vnum;const e=this.X[t],i=this.Y[t],n=this._z(e,i);this._w(n,s),this.VZ[s]=n;const h=[];return this.vnum>=this.vsize-1&&(this.VZ=h,this.vsize=2*this.vsize),this.vnum+=1,s}_ac(t){return this._y(this.VZ[t],t),this.VZ[t]=-1,1}_ad(t){t=parseInt(t);const s=this.X[t],e=this.Y[t],i=parseInt(this._z(s,e)),n=parseInt(this.VZ[t]);return n<0?-1:i!=n?(this._y(n,t),this._w(i,t),this.VZ[t]=i,1):-1}}const SIZE=400,CO=5,RYTHM=3,INDEX=1,RS=SIZE,NMAX=1e5,ONE=1/RS,STP=ONE,NEARL=3*ONE,FARL=30*ONE,INIT_RAD=6*ONE,INIT_NUM=4,MID=.5,TWOPI=2*Math.PI;let FRONT,BACK,CURRENTSIZE,gf,DF,cf,sl,ctx,init_front,np_coords=[],sc=1,dp=[],pp=[],pn=parseInt(SIZE/30),ps=!1,pe=!1,pf=!1,cs=[],ci=0,co=1,fs=[];function preload(){BACK=[0,0,0];let t=(FRONT=[[255,0,0],[0,255,0]])[0],s=FRONT[1];if(t[0]>s[0])for(let e=t[0];e>=s[0];e--)cs.push([e,t[1],t[2]]);else for(let e=t[0];e<=s[0];e++)cs.push([e,t[1],t[2]]);if(t[1]>s[1])for(let e=t[1];e>=s[1];e--)cs.push([s[0],e,t[2]]);else for(let e=t[1];e<=s[1];e++)cs.push([s[0],e,t[2]]);if(t[2]>s[2])for(let e=t[2];e>=s[2];e--)cs.push([s[0],s[1],e]);else for(let e=t[2];e<=s[2];e++)cs.push([s[0],s[1],e])}function setup(){let t=document.getElementById("canvas");t.width=SIZE,t.height=SIZE,ctx=t.getContext("2d"),sc=1,RYTHM>2?(CURRENTSIZE=RS,step_unit=parseInt(RS/(RYTHM-1)),sl=parseInt(RS/(RYTHM-1))):sl=step_unit=CURRENTSIZE=RS,gf=!0,ci=0,Math.seedrandom(INDEX),cf=CO>4&&CO<9?FRONT[0]:FRONT,DF=new DifferentialLine(NMAX,2*FARL,NEARL,FARL);let s=[];for(let t=0;t<INIT_NUM;t++)s.push(Math.random()*TWOPI);s.sort(),DF._l(MID,MID,INIT_RAD,s),init_front=cf,draw()}function draw(){cf=cs[ci],ci>=cs.length-1&&(co=2),ci<=0&&(co=1),1==co?ci++:ci--,wrap(),requestAnimationFrame(draw)}function wrap(){for(let t=0;t<NMAX;t++)np_coords[t]=[0,0,0,0];let t=steps(DF),s=DF._j(np_coords),e=np_coords.slice(0,s);if(ps)e=pp.shift(),pp.length>=pn*sc?(pe=!0,pf=!1):(pe=!1,pf=!0);else if(gf?dp.push(e):e=dp.pop(),null==e)return void setup();_s();for(let t=0;t<e.length;t++){let s=e[t];_t(s[0],s[1],s[2],s[3],ONE/3)}return t}function steps(t){if(ps)0==pp.length&&(ps=!1,sc<RYTHM-1?sc++:sc=1,sl=step_unit*sc);else if(gf&&(t._q(STP),_d(t,NEARL,.5)),check_step(sl,t))if(sc<RYTHM-1){ps=!0;let t=dp.length;for(let s=1;s<=pn*sc;s++)pp.push(dp[t-s]);for(let s=pn*sc;s>0;s--)pp.push(dp[t-s])}else 1==RYTHM&&cancelAnimationFrame(draw),gf&&(cancelAnimationFrame(draw),sleep(1e3*parseInt(RYTHM+1)),requestAnimationFrame(draw)),gf=!1}function check_step(t,s){CURRENTSIZE=t;let e=s._n(3*STP)<0;return CURRENTSIZE=RS,e}function sleep(t){const s=Date.now();let e=null;do{e=Date.now()}while(e-s<t)}preload(),setup();
</script></canvas></body></html>